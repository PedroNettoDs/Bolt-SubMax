{% extends "components/base.html" %}
{% block title %}Home{% endblock %}

{% block head-base %}
  <style>
    .style-body { background-color: #e5e7eb; }
    .style-editado { padding-left: 240px;}
    .style-edit-card-dash {
      background: #fff; border-radius: 12px; padding: 16px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.05);
    }

    .style-edit-graf {
      padding-left: 250px;
      padding-right: 250px;
      padding-top: 2%;
    }

    .lyd_edit {
      padding-left: 250px;
      padding-right: 250px;
    }

    .chart-container {
      width: 100px; height: 100px; position: relative; margin: auto;
    }
    .chart-number {
      position: absolute; top: 45%; left: 50%;
      transform: translate(-50%, -50%);
      font-size: 1.2rem; font-weight: 600; color: #0d47a1;
    }
    .aluno-lista, .calendar-box {
      background: #fff; border-radius: 12px; padding: 16px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.05);
    }
    .btn-custom { font-size: 0.875rem; padding: 6px 12px; border-radius: 6px; }
    .list-group-item small { font-size: 0.75rem; color: #6c757d; }
    .list-group-item strong { font-size: 0.9rem; }
    .btn-primary {
      background-color: #0d47a1 !important;
      border-color: #0d47a1 !important;
    }
    .btn-outline-primary {
      color: #0d47a1 !important;
      border-color: #0d47a1 !important;
    }
    .btn-outline-primary:hover {
      background-color: #0d47a1 !important;
      color: white !important;
    }
    
      .fc .fc-button-primary {
        background-color: transparent;
        border: none;
        color: #0d47a1;
      }

      .fc-toolbar-title {
        font-size: 1.5rem;
        font-weight: 600;
        text-transform: capitalize;
      }

      .fc-col-header-cell-cushion {
        font-weight: 500;
        font-size: 1rem;
        text-transform: lowercase;
        color: #0d47a1;
      }

      .fc-daygrid-day-number {
        display: flex;
        justify-content: center;
        align-items: center;
        width: 32px;
        height: 32px;
        margin: auto;
        font-size: 0.85rem;
        font-weight: 500;
        color: #111;
        border-radius: 50%;
        transition: background-color 0.3s ease;
      }

      .fc-day-today .fc-daygrid-day-number {
        background-color: #0d47a1;
        color: white;
        font-weight: 600;
      }

      .fc-day-other .fc-daygrid-day-number {
        color: #ccc;
      }

      .fc-theme-standard td,
      .fc-theme-standard th {
        border: none;
      }
  </style>
{% endblock %}

{% block body-base %}
      <!-- Área principal do conteúdo -->
  <div class="main-content style-editado container-fluid mt-4 px-4 teste1">
    <div class="row text-center g-4 graf_edit style-edit-graf">
      <div class="col-6 col-md-3">
        <div class="card-dashboard style-edit-card-dash">
          <p class="mb-1">Ativos</p>
          <div class="chart-container">
            <canvas id="chartAtivos"></canvas>
            <div class="chart-number">{{ ativos }}</div>
          </div>
        </div>
      </div>
      <div class="col-6 col-md-3">
        <div class="card-dashboard style-edit-card-dash">
          <p class="mb-1">Personais concluídos</p>
          <div class="chart-container">
            <canvas id="chartConcluidos"></canvas>
            <div class="chart-number">5</div>
          </div>
        </div>
      </div>
      <div class="col-6 col-md-3">
        <div class="card-dashboard style-edit-card-dash">
          <p class="mb-1">Avaliações realizadas</p>
          <div class="chart-container">
            <canvas id="chartAvaliacoes"></canvas>
            <div class="chart-number">2</div>
          </div>
        </div>
      </div>
      <div class="col-6 col-md-3">
        <div class="card-dashboard style-edit-card-dash">
          <p class="mb-1">Treinos montados</p>
          <div class="chart-container">
            <canvas id="chartTreinos"></canvas>
            <div class="chart-number">7</div>
          </div>
        </div>
      </div>
    </div>

    <div class="row mt-4 g-4 lyd_edit">
      <div class="col-lg-4">
        <div class="calendar-box">
          <div id="calendar"></div>
        </div>
      </div>

      <div class="col-lg-5">
        <div class="aluno-lista">
          <h6 class="mb-3">Próximos alunos:</h6>
          <ul class="list-group list-group-flush">
            {% for i in "1234" %}
            <li class="list-group-item d-flex justify-content-between align-items-center px-0">
              <div>
                <img src="../../../static/img/user.png" alt="Avatar" height="35">
                <strong>Nome Aluno 1</strong><br>
                <small>Seg, Qua, Sexta - Trimestral</small>
              </div>
              <i class="bi bi-whatsapp text-success fs-5"></i>
            </li>
            {% endfor %}
          </ul>
        </div>
      </div>

      <div class="col-lg-3 d-flex flex-column gap-2">
        <button data-bs-toggle="modal" data-bs-target="#alunoModal" class="btn btn-primary btn-sm btn-custom d-flex align-items-center justify-content-center">
          <i class="bi bi-person-plus me-2"></i> Cadastrar Aluno
        </button>
        <a href="{% url 'alunos' %}" class="btn btn-outline-primary btn-sm btn-custom d-flex align-items-center justify-content-center">
          <i class="bi bi-people me-2"></i> Mostrar todos
        </a>
      </div>
    </div>
  </div>


  {% include 'components/modal/modalAluno.html' %}

  <!-- Scripts -->
  
 <script>
  const charts = [
      { id: 'chartAtivos', valor: parseFloat('{{ percent|default:"0" }}') },
      { id: 'chartConcluidos', valor: 5 },
      { id: 'chartAvaliacoes', valor: 2 },
      { id: 'chartTreinos', valor: 7 }
    ];
    charts.forEach(({id, valor}) => {
      new Chart(document.getElementById(id), {
        type: 'doughnut',
        data: {
          datasets: [{
            data: [valor, 100 - valor],
            backgroundColor: ['#0d47a1', '#e0e0e0'],
            borderWidth: 1
          }]
        },
        options: {
          cutout: '75%',
          plugins: { legend: { display: false } }
        }
      });
    });

    document.addEventListener('DOMContentLoaded', function () {
      const calendarEl = document.getElementById('calendar');
      const calendar = new FullCalendar.Calendar(calendarEl, {
        initialView: 'dayGridMonth',
        locale: 'pt-br',
        height: 350,
        headerToolbar: {
          left: 'prev',
          center: 'title',
          right: 'next'
        },
        events: []
      });
      calendar.render();
    });
  </script>

<!-- Script adicional para carregar eventos reais no calendário -->
<script src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.9/index.global.min.js"></script>
<script>
  document.addEventListener('DOMContentLoaded', function () {
    const calendarEl = document.getElementById('calendar');
    const calendar = new FullCalendar.Calendar(calendarEl, {
      initialView: 'dayGridMonth',
      locale: 'pt-br',
      height: 500,
      editable: true,
      headerToolbar: {
        left: 'prev',
        center: 'title',
        right: 'next'
      },
      buttonText: {
        today: 'Hoje',
        month: 'Mês',
        week: 'Semana'
      },
      events: '/eventos_json/'
    });
    calendar.render();
  });
</script>
{% endblock %}



